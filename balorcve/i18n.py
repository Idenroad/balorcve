import os

translations = {
    "fr": {
        "download_start": "Téléchargement depuis {url} ...",
        "download_success": "Téléchargé et sauvegardé dans {path}",
        "download_fail": "Échec du téléchargement : {error}",
        "decompress_start": "Décompression de {path} ...",
        "decompress_success": "Décompression terminée dans {path}",
        "decompress_fail": "Échec de la décompression : {error}",
        "import_start": "Import des CVE depuis {path} ...",
        "import_success": "Import de {count} CVE terminé",
        "db_insert_error": "Erreur insertion DB pour {cve_id} : {error}",
        "search_results_title": "Résultats de la recherche CVE",
        "index": "Index",
        "cve_id": "CVE ID",
        "description": "Description",
        "score": "Score",
        "severity": "Sévérité",
        "na": "N/A",
        "no_description": "Pas de description",
        "published": "Publié",
        "last_modified": "Dernière modification",
        "references": "Références",
        "no_references": "Pas de références",
        "cve_details": "Détails CVE",
        "offline_menu_title": "Menu Offline",
        "download_cve_year": "Télécharger un fichier CVE par année",
        "download_cve_modified": "Télécharger les plus récents (modified)",
        "redownload_current_year": "Retélécharger l'année courante",
        "search_cve": "Rechercher un CVE",
        "quit": "Quitter",
        "choice": "Choix",
        "enter_year": "Année ({start}-{end})",
        "invalid_year": "Année invalide",
        "enter_keywords": "Mots-clés (laisser vide pour tous)",
        "enter_year_optional": "Année (laisser vide pour tous)",
        "enter_min_score": "Score minimum (ex: 0.0)",
        "enter_severity": "Sévérité (LOW, MEDIUM, HIGH, CRITICAL) ou vide",
        "invalid_severity": "Sévérité invalide",
        "no_results": "Aucun résultat trouvé",
        "select_cve_index": "Sélectionner un CVE par index, ou 'r' pour revenir",
        "invalid_index": "Index invalide",
        "online_search_title": "Recherche CVE en ligne via API NVD",
        "api_error": "Erreur API : {error}",
        "html_saved": "Détails CVE sauvegardés au format HTML dans {path}",
        "details_not_found": "Détails non trouvés",
        "cve_not_found": "CVE {cve_id} non trouvé dans la base",
        "no_local_data": "Aucune donnée CVE locale trouvée.",
        "download_default_2025": "Voulez-vous télécharger le fichier 2025 par défaut ? (y/n)",
        "manual_download_info": "Vous pouvez télécharger manuellement depuis https://nvd.nist.gov/vuln/data-feeds",
        "main_menu_title": "Menu principal",
        "offline_mode": "Mode offline (avec données locales)",
        "online_mode": "Mode online (via API NVD)",
        "interrupted": "Interrompu par l'utilisateur",
    },
    "en": {
        "download_start": "Downloading from {url} ...",
        "download_success": "Downloaded and saved to {path}",
        "download_fail": "Download failed: {error}",
        "decompress_start": "Decompressing {path} ...",
        "decompress_success": "Decompressed to {path}",
        "decompress_fail": "Decompression failed: {error}",
        "import_start": "Importing CVEs from {path} ...",
        "import_success": "Imported {count} CVEs successfully",
        "db_insert_error": "DB insert error for {cve_id}: {error}",
        "search_results_title": "CVE Search Results",
        "index": "Index",
        "cve_id": "CVE ID",
        "description": "Description",
        "score": "Score",
        "severity": "Severity",
        "na": "N/A",
        "no_description": "No description",
        "published": "Published",
        "last_modified": "Last Modified",
        "references": "References",
        "no_references": "No references",
        "cve_details": "CVE Details",
        "offline_menu_title": "Offline Menu",
        "download_cve_year": "Download CVE file by year",
        "download_cve_modified": "Download the most recent (modified)",
        "redownload_current_year": "Redownload current year",
        "search_cve": "Search CVE",
        "quit": "Quit",
        "choice": "Choice",
        "enter_year": "Year ({start}-{end})",
        "invalid_year": "Invalid year",
        "enter_keywords": "Keywords (leave empty for all)",
        "enter_year_optional": "Year (leave empty for all)",
        "enter_min_score": "Minimum score (e.g., 0.0)",
        "enter_severity": "Severity (LOW, MEDIUM, HIGH, CRITICAL) or empty",
        "invalid_severity": "Invalid severity",
        "no_results": "No results found",
        "select_cve_index": "Select a CVE by index, or 'r' to return",
        "invalid_index": "Invalid index",
        "online_search_title": "Online CVE search via NVD API",
        "api_error": "API error: {error}",
        "html_saved": "CVE details saved as HTML to {path}",
        "details_not_found": "Details not found",
        "cve_not_found": "CVE {cve_id} not found in DB",
        "no_local_data": "No local CVE data found.",
        "download_default_2025": "Do you want to download the default 2025 file? (y/n)",
        "manual_download_info": "You can manually download from https://nvd.nist.gov/vuln/data-feeds",
        "main_menu_title": "Main Menu",
        "offline_mode": "Offline mode (with local data)",
        "online_mode": "Online mode (via NVD API)",
        "interrupted": "Interrupted by user",
    }
}

def msg(key):
    lang = os.getenv("BALORCVE_LANG", "fr")
    return translations.get(lang, translations["fr"]).get(key, key)
